---
title: TypeScript SDK
description: Lightweight TypeScript client for implementing Superagent in your app
---

A lightweight client for calling the Superagent Guard and Redact endpoints from TypeScript or JavaScript projects.

## Installation

```bash title="Terminal"
npm install superagent-ai
# or
pnpm add superagent-ai
# or
yarn add superagent-ai
```

## Usage

```ts title="index.ts"
import { createClient } from "superagent-ai";

const client = createClient({
  apiBaseUrl: process.env.SUPERAGENT_API_BASE_URL, // Optional, defaults to https://app.superagent.sh/api
  apiKey: process.env.SUPERAGENT_API_KEY!,
});

// Guard: Analyze commands for security threats
const guardResult = await client.guard("Write a hello world script", {
  onBlock: (reason) => {
    console.warn("Guard blocked command:", reason);
  },
  onPass: () => {
    console.log("Guard approved command!");
  },
});

if (guardResult.rejected) {
  console.log("Blocked:", guardResult.reasoning);
} else {
  console.log("Approved");
}

// Redact: Remove sensitive data from text
const redactResult = await client.redact(
  "My email is john@example.com and SSN is 123-45-6789"
);

console.log(redactResult.redacted);
// Output: "My email is <REDACTED_EMAIL> and SSN is <REDACTED_SSN>"
```

## API Reference

### `createClient(options)`

Creates a new Superagent client.

**Options:**
- `apiKey` (required) – API key provisioned in Superagent
- `apiBaseUrl` (optional) – Base URL for the API (defaults to `https://app.superagent.sh/api`)
- `fetch` (optional) – Custom fetch implementation (defaults to global `fetch`)
- `timeoutMs` (optional) – Request timeout in milliseconds

### `client.guard(command, callbacks?)`

Analyzes a command for security threats.

**Parameters:**
- `command` – The text to analyze
- `callbacks` (optional) – Object with `onPass` and `onBlock` callbacks

**Returns:** `Promise<GuardResult>`

```ts
interface GuardResult {
  rejected: boolean;        // True if guard blocked the command
  decision?: GuardDecision; // Parsed decision details
  usage?: GuardUsage;       // Token usage statistics
  reasoning: string;        // Explanation from the guard
  raw: AnalysisResponse;    // Full API response
}

interface GuardDecision {
  status: "pass" | "block";
  violation_types?: string[];
  cwe_codes?: string[];
}
```

### `client.redact(text, options?)`

Redacts sensitive data from text.

**Parameters:**
- `text` – The text to redact
- `options` (optional) – Options object
  - `urlWhitelist` – Array of URL prefixes that should not be redacted. URLs matching these prefixes will be preserved in the output.
  - `entities` – Array of natural language descriptions of PII entities to redact. Examples: `["credit card numbers", "email addresses", "phone numbers"]`

**Returns:** `Promise<RedactResult>`

```ts
interface RedactResult {
  redacted: string;      // Text with sensitive data redacted
  reasoning: string;     // Explanation of what was redacted
  usage?: GuardUsage;    // Token usage statistics
  raw: RedactionResponse; // Full API response
}
```

## Detected PII/PHI Types

The redaction feature detects and replaces:

- **Email addresses** → `<REDACTED_EMAIL>`
- **Social Security Numbers** → `<REDACTED_SSN>`
- **Credit cards** (Visa, Mastercard, Amex) → `<REDACTED_CC>`
- **Phone numbers** (US format) → `<REDACTED_PHONE>`
- **IP addresses** (IPv4/IPv6) → `<REDACTED_IP>`
- **API keys & tokens** → `<REDACTED_API_KEY>`
- **AWS access keys** → `<REDACTED_AWS_KEY>`
- **Bearer tokens** → `Bearer <REDACTED_TOKEN>`
- **MAC addresses** → `<REDACTED_MAC>`
- **Medical record numbers** → `<REDACTED_MRN>`
- **Passport numbers** → `<REDACTED_PASSPORT>`
- **IBAN** → `<REDACTED_IBAN>`
- **ZIP codes** → `<REDACTED_ZIP>`

## Custom Entity Redaction

You can specify custom entities to redact using natural language descriptions by passing an `entities` option to the `redact()` method:

```ts title="custom-entities-example.ts"
const client = createClient({
  apiKey: process.env.SUPERAGENT_API_KEY!,
});

const result = await client.redact(
  "My credit card is 4532-1234-5678-9010 and my email is john@example.com",
  { entities: ["credit card numbers", "email addresses"] }
);
// The model will redact the specified entity types based on your natural language descriptions
```

**How it works:**
- The `entities` array is sent to the redaction API in the request body
- You can describe entities in natural language (e.g., "credit card numbers", "social security numbers", "phone numbers")
- The AI model interprets your descriptions and redacts matching content
- This allows for flexible, context-aware redaction beyond predefined patterns

**Examples of entity descriptions:**
- `["credit card numbers", "social security numbers"]`
- `["email addresses", "phone numbers", "IP addresses"]`
- `["API keys", "passwords", "authentication tokens"]`
- `["medical record numbers", "patient names"]`
- `["company names", "project codenames"]`

## URL Whitelisting

You can specify URLs that should not be redacted by passing a `urlWhitelist` option to the `redact()` method:

```ts title="url-whitelist-example.ts"
const client = createClient({
  apiKey: process.env.SUPERAGENT_API_KEY!,
});

const result = await client.redact(
  "Check out https://github.com/user/repo and https://secret.com/data",
  { urlWhitelist: ["https://github.com", "https://example.com"] }
);
// Output: "Check out https://github.com/user/repo and <URL_REDACTED>"
```

The whitelist is applied **locally after redaction**, meaning:
1. The text is sent to the redact API (URLs are not yet redacted by the API)
2. The response is processed locally
3. URLs **not** matching the whitelist prefixes are replaced with `<URL_REDACTED>`
4. URLs matching the whitelist prefixes are preserved as-is
5. The final result is returned

**How it works:**
- Whitelisted URLs (those starting with any prefix in `urlWhitelist`) remain unchanged
- Non-whitelisted URLs are replaced with `<URL_REDACTED>`
- The matching is done using prefix comparison (e.g., `"https://github.com"` matches `"https://github.com/user/repo"`)

## Error Handling

```ts title="error-handling.ts"
import { GuardError } from "superagent-ai";

try {
  const result = await client.guard("command");
} catch (error) {
  if (error instanceof GuardError) {
    console.error("Guard error:", error.message);
  }
}
```
